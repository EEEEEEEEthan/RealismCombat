# 待办

[ ] 身体部位血量系统
  [x] BodyPart增加public readonly BodyPartCode id 字段
  [x] 定义ICombatTarget接口并为角色、身体部位提供实现
  [x] 改造玩家与AI攻击决策流程以选择ICombatTarget
  [x] 需要可以返回的MenuDialogue.CreateDialogue增加参数,是否可以Esc返回.
    [x] 有esc时,自动追加选项"返回"
    [x] 选择返回或者esc会await得到对应下标
    [x] 攻击目标的身体部位菜单支持返回
    [x] 攻击选择目标角色的菜单需要支持返回
  [x] 在Combat结算中使用部位血量并同步日志与动画
  [x] 以头部或躯干血量归零作为死亡判定来源
  [ ] 移除角色全局 `HP` 字段并提供序列化兼容与引用迁移
  [ ] 调整 `CharacterNode` 血量展示为头部/躯干较大值
  [ ] 巡检UI与战斗流程确保不再出现旧 `HP` 引用
[ ] 装备系统
  [ ] 定义装备类型enum(mask)
  [ ] 定义装备类,实现ICombatTarget
  [ ] 定义装备槽接口.装备槽可以放装备(可能嵌套)
  [ ] 战斗中可以抽出装备在皮带上的武器
[ ] 反应系统
  [ ] 每回合获得1个反应
  [ ] CharacterNode需要绘制反应
  [ ] 即将遭受攻击时可以选择格挡,闪避,承受
  [ ] 格挡选择一个自己的ICombatTarget进行格挡
  [ ] 闪避会打断自己的行动
[ ] buff系统
  [ ] 定义IBuffOwner接口

# 最美角落

## 武器卡住

Ethan的短剑精准刺入了Dove胸甲缝隙!
Dove死了
Ethan的短剑卡在Dove的胸甲缝隙里拔不出来
Ethan尝试用力拔出短剑

## 武器断裂

Ethan的斩击
Dove用钉头锤挡住了Ethan的斩击
Ethan的长剑断了!

## 面罩

Ethan束缚住了Jack!
Dove掀开了Jack的面罩!
Dove用匕首刺进Jack的眼球!

## 流血

角色卡片有流血动画

# 悬而未决
